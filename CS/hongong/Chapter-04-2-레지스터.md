## 학습 키워드

- `프로그램 카운터` `명령어 레지스터` `메모리 주소/버퍼 레지스터` `범용/플래그 레지스터` `스택 포인터` `베이스 레지스터`
- 레지스터의 종류와 역할
- 레지스터를 통해 명령어가 처리되는 과정

## 공부해야 하는 이유

- 프로그램 속 명령어와 데이터는 실행 전후에 반드시 레지스터에 저장된다. 그렇기 때문에 레지스터에 저장된 값만 잘 관찰해도 프로그램의 실행 흐름을 파악할 수 있다.

---

# 반드시 알아야 할 레지스터 8가지

1. 프로그램 카운터 
2. 명령어 레지스터 
3. 메모리 주소 레지스터
4. 메모리 버퍼 레지스터 
5. 범용 레지스터 
6. 플래그 레지스터
7. 스택 포인터 
8. 베이스 레지스터

## 프로그램 카운터 (Program Counter)

- 메모리에서 읽어 들일 명령어의 주소를 저장하는 레지스터
- 명령어 포인터라고도 불린다.

## 명령어 레지스터 (Instruction Register)

- 해석할 명령어(방금 메모리에서 읽어 들인 명령어)를 저장하는 레지스터

## 메모리 주소 레지스터 (Memory Address Register)

- 메모리의 주소를 저장하는 레지스터

## 메모리 버퍼 레지스터 (Memory Buffer Register)

- 메모리와 주고받을 값(데이터와 명령어)을 저장하는 레지스터
- 메모리 데이터 레지스터(Memory Data Register) 라고도 부른다.

## 레지스터는 어떻게 작동하는가?

- 레지스터 작동 순서

## 범용 레지스터 (General Purpose Register)

- 다양하고 일반적인 상황에서 자유롭게 사용할 수 있는 레지스터
- 다른 레지스터들은 특정 용도로 사용되지만 범용 레지스터는 데이터와 주소를 모두 저장할 수 있다.

## 플래그 레지스터 (Flag Register)

- 연산 결과 또는 CPU 상태에 대한 부가적인 정보를 저장하는 레지스터

---

# 특정 레지스터를 이용한 주소 지정 방식

프로그램 카운터, 스택 포인터, 베이스 레지스터는 주소 지정에 사용될 수 있는 특별한 레지스터이다.

- **스택 포인터**
    - 스택 주소 지정 방식이라는 주소 지정 방식에 사용
- 프로그램 카운터, **베이스 레지스터**
    - 변위 주소 지정 방식이라는 주소 지정 방식에 사용

## 스택 주소 지정 방식

- 스택과 스택 포인터를 이용한 주소 지정 방식
- **스택 포인터**
    - 스택의 꼭대기를 가리키는 레지스터
    - 스택에 마지막으로 저장한 값의 위치를 저장하는 레지스터
    - 스택의 어디까지 데이터가 채워져 있는지에 대한 표시
- 스택은 어디에 있는 걸까?
    - 메모리 안에 스택처럼 사용할 영역이 정해져 있다. (**스택 영역**)
    - 스택 영역은 다른 주소 공간과는 다르게 스택처럼 사용하기로 암묵적으로 약속된 영역이다.

## 변위 주소 지정 방식

- **오퍼랜드** 필드의 값(변위)과 **특정 레지스터**의 값을 더하여 유효 주소를 얻어내는 주소 지정 방식
- 변위 주소 지정 방식을 사용하는 명령어 필드 구조
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/19ac75ca-96cd-4608-aa84-56d0e48268c8/f4c784f7-47ce-48e5-b514-f6593bae1bfd/Untitled.png)
    
- 오퍼랜드 필드의 주소와 어떤 레지스터를 더하는지에 따라 상대 주소 지정방식, 베이스 레지스터 주소 지정 방식으로 나뉜다.

### 상대 주소 지정 방식 (relative addressing mode)

- **오퍼랜드**와 **프로그램 카운터**의 값을 더하여 유효 주소를 얻는 방식
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/19ac75ca-96cd-4608-aa84-56d0e48268c8/591a84ca-0c0f-48cf-b2af-75e8ffdccc42/Untitled.png)
    
    - 오퍼랜드가 -3 이었다면 CPU는 실행하려는 명령어의 세 칸 이전 번지의 명령어를 실행
    - 오퍼랜드가 3 이었다면 CPU는 실행하려는 명령어의 세 칸 건너뛴 번지를 실행

### 베이스 레지스터 주소 지정 방식 (base-register addressing mode)

- **오퍼랜드**와 **베이스 레지스터**의 값을 더하여 유효 주소를 얻는 방식
- 베이스 레지스터
    - 기준 주소
- 오퍼랜드
    - 기준 주소로부터 떨어진 거리
- 기준 주소로부터 얼마나 떨어져 있는 주소에 접근할 것인지를 연산하여 유효 주소를 얻어내는 방식
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/19ac75ca-96cd-4608-aa84-56d0e48268c8/17a9f579-bc2f-42ed-8d90-595a6ea81f1f/Untitled.png)
    
    - 베이스 레지스터에 200 이라는 값이 있고 오퍼랜드가 40일 때 → 기준 주소 200번지로부터 40만큼 떨어진 240번지로 접근하라!